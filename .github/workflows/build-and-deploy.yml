name: Build & Deploy
on: 
  push:
    tags:
      - '**'

jobs: 
  build-deploy:
    name: Build & Deploy
    
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: Update & Install Prequisities
        run: |
          docker pull emscripten/emsdk
          docker run -di --name emscripten -v $(pwd):/src emscripten/emsdk bash
          docker exec -i emscripten apt update
          docker exec -i emscripten apt -y install autoconf libtool dh-autoreconf pkg-config
      - name: Build libyara
        run: docker exec -i emscripten /bin/sh -c 'mkdir -p /system/lib && mkdir build && cd build && emcmake cmake .. && emmake make'

